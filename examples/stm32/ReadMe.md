# Пример использования библиотеки на stm32
- Сделан для работы только с одним modbus портом
- Все необходимые настройки делаются в niva_modbus_stm32_config.h

## Принцип работы:

- По умолчанию сервер запущен на прием в режиме dma.
- При запуске на прием - запускается таймер с интервалом в 3.5 символа юарта для отслеживания конца отправки пакета.
- По приему каждого символа по юарту происходит сброс счетчика таймера. Таким образом он не завершается до окончания приема пакета.
- По сработке таймера или приему максимальной длины пакета (256 символов) - запускается обработка пакета:
    - останавливается прием, если он не остановлен
    - сохраняется полученный RxPacket (указатель на начало буфера и его длину)
    - затем смещается текущий указатель приема на буфере RX_BUFFER для продолжения приема
- Полученный пакет обрабатывается в функции modbus_update.
- По заверщению обработки полученный ответ отправляется.
- По заверщению отправки сервер снова переходит в состояние приема.

## Todo list:

- [ ] сделать обработку ошибок uart'a (Noise detection and other)
- [ ] проверить работу с DMA2 (исправить ошибки, если необходимо)
- [ ] сделать timeout по приему